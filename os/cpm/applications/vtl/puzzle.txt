00100 ) 
00110 ) 15puzzle
00120 )
00200 ) Initialize
00210 I=0
00220 #=I>16*260
00230 :I)=I
00240 I=I+1
00250 #=220
00260 Z=15
00300 ) Shuffle
00305 P=4
00310 I=0
00320 #=I>100*500
00330 A='/4
00340 D=%
00345 #=D=P*330
00350 A=Z/4
00360 #=(D=0*(A=0))+(D=1*(%=3))+(D=2*(A=3))+(D=3*(%=0))*330
00370 P=D+2/4
00371 P=%
00380 W=Z-(D=0*4)+(D=1)+(D=2*4)-(D=3)
00390 :Z)=:W)
00400 :W)=15
00410 Z=W
00420 I=I+1
00430 #=320
00500 ) Main
00510 #=1000
00520 I=0
00530 #=I>16*900
00540 #=1-(I=:I))*600
00550 I=I+1
00560 #=530
00600 K=$
00605 $=""
00610 A=Z/4
00620 W=Z+(4*(K=56)*(A<3))-(4*(K=50)*(A>1))
00625 W=W+((K=52)*(%<3))-((K=54)*(%>1))
00630 :Z)=:W)
00640 :W)=15
00650 Z=W
00660 #=510
00900 ?="Game Clear !"
00910 #=65535
01000 ) Display
01010 R=!
01020 I=0
01030 #=I>4*1130
01040 J=0
01050 #=J>4*1100
01060 N=:I*4+J)
01070 $=48+N+(N>10*7)-(N=15*38)
01080 J=J+1
01090 #=1050
01100 ?=""
01110 I=I+1
01120 #=1030
01140 #=R
